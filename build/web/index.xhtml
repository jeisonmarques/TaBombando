<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html">
    <h:head>
        <title>Facelet Title</title>
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBKqzOmKPmRF1qW_PqrHdh5RXCUhnzOPNo"></script>
        <script type="text/javascript">
            //<![CDATA[
        var data = [
        {'lat':-30.0242309, 'lng':-51.2027522, 'qtd':30, 'raio':2.5, 'nome':'Tomas Bar'},
        {'lat':-30.0472355, 'lng':-51.2056313, 'qtd':60, 'raio':6, 'nome':'Stutigrada'},
        {'lat':-30.041789, 'lng':-51.2208116, 'qtd':50, 'raio':6, 'nome':'Opiniao'},
        {'lat':-30.0412731, 'lng':-51.2250391, 'qtd':35, 'raio':3, 'nome':'Preto ZÃ©'}];
        console.log(data);
        function initialize() {
          var mapProp = {
            center:{lat: -30.02, lng: -51.202},
            zoom:12,
            mapTypeId:google.maps.MapTypeId.ROADMAP
          };
          var map=new google.maps.Map(document.getElementById("googleMap"),mapProp);
          	for(var y = 0; y< data.length; y++){
		var randomGeoPoints = generateRandomPoints(data[y]);
		for(var i = 0; i< randomGeoPoints.length; i++)
		{
			var marker = new google.maps.Marker({
			map: map,
			position: randomGeoPoints[i],
			title: data[y].nome
			});
			if (i % 2 == 0) {
				marker.setIcon('./img/dancing-a.png')
			}
			else
			{
				marker.setIcon('./img/dancing-r.png')
			}
		}
	}
        }
        
        google.maps.event.addDomListener(window, 'load', initialize);
        

function generateRandomPoints(data) {
  var points = [];
  for (var i=0; i< data.qtd; i++) {
    points.push(generateRandomPoint(data));
  }
  return points;
}
function generateRandomPoint(data) {
  var x0 = data.lng;
  var y0 = data.lat;

  var rd = data.raio/111300;

  var u = Math.random();
  var v = Math.random();

  var w = rd * Math.sqrt(u);
  var t = 2 * Math.PI * v;
  var x = w * Math.cos(t);
  var y = w * Math.sin(t);

  var xp = x/Math.cos(y0);

  return {'lat': y+y0, 'lng': xp+x0};
}
        //]]>
        </script>

    </h:head>
    <h:body>
        <h:form>
        <h:commandButton value="login" action="login"></h:commandButton>
        <div id="googleMap" style="width:100%;height:450px;"></div>
        teste
        </h:form>
    </h:body>
</html>

